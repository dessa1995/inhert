<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìƒì†ë²• ì‚¬ë¡€ ë¶„ì„ ì‹œë®¬ë ˆì´í„°</title>
    <style>
        :root {
            --primary-bg: #f4f7f9;
            --secondary-bg: #ffffff;
            --card-bg: #e9eef2;
            --text-color: #2c3e50;
            --body-text-color: #34495e;
            --accent-color: #3498db;
            --accent-color-darker: #2980b9;
            --error-color: #e74c3c;
            --error-color-darker: #c0392b;
            --success-color: #2ecc71;
            --success-color-darker: #27ae60;
            --font-main: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            font-family: var(--font-main);
            background-color: var(--primary-bg);
            color: var(--body-text-color);
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .container {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #scene-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            pointer-events: none;
        }
        
        .ui-panel {
            position: relative;
            z-index: 2;
            width: 95%;
            max-width: 1200px;
            background-color: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(10px);
            border: 1px solid #dce4ec;
            border-radius: 15px;
            padding: 2rem 2.5rem;
            box-shadow: 0 10px 30px rgba(44, 62, 80, 0.1);
            animation: fadeIn 1s ease-in-out;
            max-height: 90vh;
            overflow-y: auto;
        }

        /* ë‚œì´ë„ ì„ íƒ í™”ë©´ */
        #difficulty-selector {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 2rem 2.5rem 3rem;
        }
        .main-title-card {
            background: linear-gradient(135deg, var(--accent-color) 0%, var(--accent-color-darker) 100%);
            color: #fff;
            padding: 1.5rem;
            border-radius: 12px;
            margin-bottom: 2.5rem;
            text-align: center;
            box-shadow: 0 8px 20px rgba(52, 152, 219, 0.3);
            width: 100%;
            max-width: 500px;
        }
        .main-title-card .title-icon { font-size: 2.5rem; display: block; margin-bottom: 0.5rem; }
        .main-title-card h2 { margin: 0; font-size: 2.2rem; font-weight: bold; }
        .main-title-card p { margin: 0.5rem 0 0; font-size: 1.1rem; opacity: 0.9; }
        #difficulty-selector h1 { color: var(--text-color); margin-bottom: 2.5rem; font-size: 2rem; }
        .difficulty-buttons { display: flex; justify-content: center; gap: 1.5rem; flex-wrap: wrap; }
        .difficulty-btn { padding: 1rem 2rem; font-size: 1.2rem; font-weight: bold; border: 2px solid var(--accent-color); border-radius: 8px; cursor: pointer; transition: all 0.3s ease; background-color: transparent; color: var(--accent-color); }
        .difficulty-btn:hover { background-color: var(--accent-color); color: #fff; box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4); transform: translateY(-5px); }

        .info-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            padding: 0.4rem 0.8rem;
            font-size: 0.85rem;
            font-weight: bold;
            border: 1px solid #bdc3c7;
            border-radius: 20px;
            cursor: pointer;
            background-color: transparent;
            color: #7f8c8d;
            transition: all 0.3s ease;
        }
        .info-btn:hover {
            background-color: #ecf0f1;
            color: #34495e;
        }

        /* ì‹œë®¬ë ˆì´í„° ë©”ì¸ í™”ë©´ */
        #simulator-main { display: none; }
        .header { display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid #e0e6ed; padding-bottom: 1rem; margin-bottom: 1.5rem; }
        .header h1 { color: var(--text-color); margin: 0; font-size: 2rem; }
        #score-display { background-color: var(--accent-color); color: #fff; padding: 0.5rem 1.5rem; border-radius: 8px; font-weight: bold; font-size: 1.4rem; transition: transform 0.3s; }
        #scenario-text, #modal-explanation { background-color: #f8f9fa; border: 1px solid #e9ecef; color: var(--body-text-color); padding: 1.5rem; border-radius: 8px; margin-bottom: 1.5rem; line-height: 1.7; font-size: 1.1rem; max-height: 200px; overflow-y: auto; }
        .legal-term { color: var(--accent-color); font-weight: bold; cursor: pointer; text-decoration: underline; text-decoration-style: dotted; }
        #interaction-area h3 { color: var(--accent-color); margin-bottom: 1rem; font-size: 1.3rem; }
        
        #drag-drop-area { display: flex; gap: 2rem; margin-top: 1.5rem; }
        #amount-card-pool { width: 50%; min-height: 150px; background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 1rem; transition: background-color 0.3s; cursor: pointer; }
        #heir-drop-zones { width: 50%; display: flex; flex-direction: column; gap: 1rem; }
        
        .amount-card-creator { background-color: #e9eef2; border-radius: 25px; padding: 0.5rem 0.5rem 0.5rem 1rem; display: flex; align-items: center; margin-bottom: 1rem; border: 1px solid #dce4ec; box-shadow: inset 0 2px 4px rgba(0,0,0,0.06); }
        .amount-card-creator .creator-icon { font-size: 1.2rem; margin-right: 0.5rem; }
        .amount-card-creator input { flex-grow: 1; border: none; background: transparent; color: var(--text-color); font-size: 1rem; padding: 0.5rem; }
        .amount-card-creator input:focus { outline: none; }
        .amount-card-creator button { padding: 0.7rem 1.2rem; margin-left: 0.5rem; background: var(--accent-color); color: #fff; border: none; border-radius: 20px; cursor: pointer; font-weight: bold; transition: background-color 0.3s; }
        .amount-card-creator button:hover { background-color: var(--accent-color-darker); }
        
        .amount-helper-btns {
            display: flex;
            gap: 0.5rem;
            margin-top: 0.5rem;
            margin-bottom: 1rem;
        }
        .helper-btn {
            flex: 1;
            padding: 0.6rem;
            font-size: 0.9rem;
            font-weight: bold;
            border: 1px solid #dce4ec;
            border-radius: 20px;
            cursor: pointer;
            background-color: #f8f9fa;
            color: var(--body-text-color);
            transition: all 0.2s ease;
        }
        .helper-btn:hover {
            background-color: #e9eef2;
            border-color: #ced8e0;
        }
        #clear-amount-btn {
            background-color: #e74c3c;
            color: white;
            border-color: transparent;
        }
        #clear-amount-btn:hover {
            background-color: #c0392b;
        }

        #card-holder { min-height: 50px; }
        .amount-card { position: relative; background: linear-gradient(135deg, var(--accent-color) 0%, var(--accent-color-darker) 100%); color: #fff; padding: 1rem; padding-right: 2.5rem; border-radius: 8px; text-align: center; font-weight: bold; cursor: pointer; user-select: none; border: 2px solid transparent; margin-top: 0.5rem; box-shadow: 0 4px 6px rgba(50,50,93,.11), 0 1px 3px rgba(0,0,0,.08); transition: transform 0.2s, box-shadow 0.2s, border-color 0.2s; }
        .amount-card:active { transform: scale(0.95); }
        .amount-card.selected {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 0 0 3px var(--secondary-bg), 0 0 0 5px var(--accent-color-darker);
        }
        .delete-card-btn { position: absolute; top: 50%; right: 10px; transform: translateY(-50%); font-size: 1.5rem; line-height: 1; font-weight: bold; color: rgba(255, 255, 255, 0.7); cursor: pointer; transition: color 0.2s, transform 0.2s; }
        .delete-card-btn:hover { color: #fff; transform: translateY(-50%) scale(1.2); }
        
        .drop-zone { background: #f8f9fa; border: 2px dashed #dce4ec; border-radius: 8px; padding: 1rem; display: flex; align-items: center; justify-content: space-between; transition: all 0.3s; min-height: 50px; cursor: pointer; }
        .drop-zone:hover { border-color: var(--accent-color); }
        .drop-zone-label { font-weight: bold; color: var(--text-color); pointer-events: none; }
        .drop-zone .amount-card { margin-left: 1rem; }

        .button-container { display: flex; justify-content: center; gap: 1rem; margin-top: 2rem; flex-wrap: wrap; }
        .action-btn { padding: 1rem 2.5rem; font-size: 1.2rem; font-weight: bold; border: none; border-radius: 8px; cursor: pointer; transition: all 0.3s ease; color: #fff; }
        #submit-btn { background-color: var(--accent-color); }
        #submit-btn:hover { background-color: var(--accent-color-darker); box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4); }
        #next-btn { display: none; }
        #next-btn.correct { background-color: var(--success-color); }
        #next-btn.correct:hover { background-color: var(--success-color-darker); }
        #next-btn.incorrect { background-color: var(--error-color); }
        #next-btn.incorrect:hover { background-color: var(--error-color-darker); }
        #back-btn { background-color: #95a5a6; }
        #back-btn:hover { background-color: #7f8c8d; }

        /* ëª¨ë‹¬ (ì •ë‹µ/ìš©ì–´ì§‘/ì‚¬ìš©ì„¤ëª…) */
        .modal { display: none; position: fixed; z-index: 100; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); animation: fadeIn 0.5s; }
        .modal-content { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background-color: var(--secondary-bg); padding: 2.5rem; border-radius: 10px; width: 80%; max-width: 700px; border-top: 5px solid; animation: slideIn 0.5s forwards; max-height: 80vh; overflow-y: auto; box-shadow: 0 10px 30px rgba(44, 62, 80, 0.2); }
        .modal .close-btn {
            position: absolute;
            top: 10px;
            right: 20px;
            font-size: 2.5rem;
            font-weight: bold;
            color: #aaa;
            cursor: pointer;
            transition: color 0.2s;
            line-height: 1;
        }
        .modal .close-btn:hover { color: #333; }
        #modal-result, #glossary-title { font-size: 2.2rem; font-weight: bold; margin-bottom: 1.5rem; text-align: center; }
        #modal-explanation, #glossary-definition { background-color: #f8f9fa; border: 1px solid #e9ecef; padding: 1.5rem; border-radius: 5px; line-height: 1.8; font-size: 1.1rem; }

        /* ê²°ê³¼ í˜ì´ì§€ */
        #results-page { display: none; text-align: center; }
        #results-page h1 { color: var(--text-color); }
        #results-summary { background: var(--secondary-bg); padding: 2rem; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
        #results-summary p { font-size: 1.5rem; margin: 1rem 0; }
        
        /* ì‚¬ìš´ë“œ ë²„íŠ¼ */
        #sound-toggle { position: fixed; top: 20px; right: 20px; z-index: 101; font-size: 1.5rem; cursor: pointer; background: #fff; border-radius: 50%; width: 40px; height: 40px; display: flex; justify-content: center; align-items: center; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideIn { from { transform: translate(-50%, -70%) scale(0.8); opacity: 0; } to { transform: translate(-50%, -50%) scale(1); opacity: 1; } }
        
        @media (max-width: 768px) {
            .ui-panel { padding: 1.5rem; max-width: 95%; }
            #drag-drop-area { flex-direction: column; }
            #amount-card-pool, #heir-drop-zones { width: 100%; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div id="scene-container"></div>
        <div id="sound-toggle">ğŸ”Š</div>

        <div id="difficulty-selector" class="ui-panel">
            <button id="how-to-use-btn" class="info-btn">ì‚¬ìš©ì„¤ëª…</button>
             <div class="main-title-card">
                 <span class="title-icon">âš–ï¸</span>
                 <h2>ì†”ë¡œëª¬ì˜ ì„ íƒ</h2>
                 <p>ìƒì† ì‚¬ë¡€ ë¶„ì„ í€´ì¦ˆ</p>
             </div>
            <h1>ë‚œì´ë„ ì„ íƒ</h1>
            <div class="difficulty-buttons">
                <button class="difficulty-btn" data-difficulty="easy">ì‰¬ì›€</button>
                <button class="difficulty-btn" data-difficulty="medium">ì¤‘ê°„</button>
                <button class="difficulty-btn" data-difficulty="hard">ì–´ë ¤ì›€</button>
                <button class="difficulty-btn" data-difficulty="very_hard">ë§¤ìš° ì–´ë ¤ì›€</button>
            </div>
        </div>

        <div id="simulator-main" class="ui-panel">
            <div class="header">
                <h1 id="simulator-title">ìƒì†ë²• ì‚¬ë¡€ ë¶„ì„</h1>
                <div id="score-display">ì ìˆ˜: 0</div>
            </div>
            <div id="scenario-text"></div>
            <div id="interaction-area">
                <h3>1. ê¸ˆì•¡ ì¹´ë“œë¥¼ ë§Œë“¤ì–´ í´ë¦­í•œ í›„, ì•„ë˜ ìƒì†ì¸ ë°•ìŠ¤ë¥¼ í´ë¦­í•˜ì—¬ ì˜®ê¸°ì„¸ìš”.</h3>
                <div id="drag-drop-area">
                    <div id="amount-card-pool">
                        <div class="amount-card-creator">
                            <span class="creator-icon">ğŸ’°</span>
                            <input type="text" id="amount-input" placeholder="ê¸ˆì•¡ ì…ë ¥ ë˜ëŠ” ë²„íŠ¼ìœ¼ë¡œ ì¶”ê°€">
                            <button id="create-card-btn">ìƒì„±</button>
                        </div>
                        <div class="amount-helper-btns">
                            <button class="helper-btn" id="add-10m-btn">+ 1ì²œë§Œ</button>
                            <button class="helper-btn" id="add-100m-btn">+ 1ì–µ</button>
                            <button class="helper-btn" id="add-1b-btn">+ 10ì–µ</button>
                            <button class="helper-btn" id="clear-amount-btn">ì§€ìš°ê¸°</button>
                        </div>
                        <div id="card-holder"></div>
                    </div>
                    <div id="heir-drop-zones"></div>
                </div>
            </div>
            <div class="button-container">
                <button id="back-btn" class="action-btn">ë‚œì´ë„ ì„ íƒìœ¼ë¡œ</button>
                <button id="submit-btn" class="action-btn">ê²°ê³¼ í™•ì¸</button>
                <button id="next-btn" class="action-btn">ë‹¤ìŒ ë¬¸ì œ</button>
            </div>
        </div>

        <div id="results-page" class="ui-panel">
            <h1>í•™ìŠµ ê²°ê³¼</h1>
            <div id="results-summary"></div>
            <div class="button-container">
                 <button id="restart-btn" class="action-btn" style="background-color: var(--accent-color);">ë‹¤ì‹œí•˜ê¸°</button>
            </div>
        </div>
    </div>

    <div id="answer-modal" class="modal">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <h2 id="modal-result"></h2>
            <div id="modal-explanation"></div>
        </div>
    </div>

    <div id="glossary-modal" class="modal">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <h2 id="glossary-title"></h2>
            <div id="glossary-definition"></div>
        </div>
    </div>
    
    <div id="how-to-use-modal" class="modal">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <h2 id="how-to-use-title" style="text-align: center; color: var(--accent-color);">í”„ë¡œê·¸ë¨ ì‚¬ìš© ì„¤ëª…</h2>
            <div id="how-to-use-content">
                <ol style="padding-left: 20px; line-height: 1.8; font-size: 1.05rem;">
                    <li style="margin-bottom: 1rem;"><strong>ë‚œì´ë„ ì„ íƒ:</strong> ë©”ì¸ í™”ë©´ì—ì„œ ì›í•˜ëŠ” í•™ìŠµ ë‚œì´ë„ë¥¼ ì„ íƒí•˜ì—¬ ì‹œì‘í•©ë‹ˆë‹¤.</li>
                    <li style="margin-bottom: 1rem;"><strong>ì‚¬ë¡€ í™•ì¸:</strong> í™”ë©´ì— ì œì‹œëœ ìƒì† ì‚¬ë¡€ë¥¼ ê¼¼ê¼¼íˆ ì½ê³  ìƒì† ê´€ê³„ë¥¼ íŒŒì•…í•©ë‹ˆë‹¤.</li>
                    <li style="margin-bottom: 1rem;"><strong>ê¸ˆì•¡ ì¹´ë“œ ìƒì„±:</strong>
                        <ul style="padding-left: 20px; margin-top: 0.5rem;">
                            <li>ê¸ˆì•¡ ì…ë ¥ì°½ì— '1ì–µ 5000ë§Œ'ê³¼ ê°™ì´ ì§ì ‘ ê¸ˆì•¡ì„ ì…ë ¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
                            <li>'+1ì²œë§Œ', '+1ì–µ' ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ê¸ˆì•¡ì„ ì‰½ê²Œ ë”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 'ì§€ìš°ê¸°' ë²„íŠ¼ìœ¼ë¡œ ì´ˆê¸°í™”í•©ë‹ˆë‹¤.</li>
                            <li>ê¸ˆì•¡ ì„¤ì • í›„ 'ìƒì„±' ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ì•„ë˜ì— ê¸ˆì•¡ ì¹´ë“œê°€ ë§Œë“¤ì–´ì§‘ë‹ˆë‹¤.</li>
                        </ul>
                    </li>
                    <li style="margin-bottom: 1rem;"><strong>ìƒì†ì•¡ ë¶„ë°°:</strong>
                        <ul style="padding-left: 20px; margin-top: 0.5rem;">
                            <li>ìƒì„±ëœ ê¸ˆì•¡ ì¹´ë“œë¥¼ í´ë¦­í•˜ì—¬ ì„ íƒí•©ë‹ˆë‹¤. (ì„ íƒëœ ì¹´ë“œëŠ” íŒŒë€ìƒ‰ í…Œë‘ë¦¬ë¡œ í‘œì‹œë©ë‹ˆë‹¤.)</li>
                            <li>ê¸ˆì•¡ì„ ë°°ë¶„í•  ìƒì†ì¸ì˜ íšŒìƒ‰ ì˜ì—­ì„ í´ë¦­í•˜ë©´, ì„ íƒëœ ì¹´ë“œê°€ í•´ë‹¹ ìƒì†ì¸ì—ê²Œ ì´ë™í•©ë‹ˆë‹¤.</li>
                            <li>ì¹´ë“œë¥¼ ì˜ëª» ì˜®ê²¼ì„ ê²½ìš°, ì˜®ê²¨ì§„ ì¹´ë“œë¥¼ ë‹¤ì‹œ í´ë¦­í•˜ì—¬ ì„ íƒí•œ í›„ ìƒë‹¨ì˜ ì¹´ë“œ ìƒì„± ì˜ì—­ì„ í´ë¦­í•˜ë©´ ì›ë˜ ìœ„ì¹˜ë¡œ ëŒì•„ì˜µë‹ˆë‹¤.</li>
                        </ul>
                    </li>
                    <li style="margin-bottom: 1rem;"><strong>ê²°ê³¼ í™•ì¸:</strong> ëª¨ë“  ê¸ˆì•¡ ë¶„ë°°ê°€ ëë‚˜ë©´ 'ê²°ê³¼ í™•ì¸' ë²„íŠ¼ì„ ëˆŒëŸ¬ ì •ë‹µê³¼ í•´ì„¤ì„ í™•ì¸í•©ë‹ˆë‹¤.</li>
                    <li><strong>ë°˜ë³µ í•™ìŠµ:</strong> 'ë‹¤ìŒ ë¬¸ì œ'ë¥¼ í’€ì–´ë³´ê±°ë‚˜ 'ë‹¤ì‹œ í’€ê¸°'ë¡œ ë³µìŠµí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 'ë‚œì´ë„ ì„ íƒìœ¼ë¡œ' ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ë©”ì¸ í™”ë©´ìœ¼ë¡œ ëŒì•„ê°‘ë‹ˆë‹¤.</li>
                </ol>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.77/Tone.js"></script>
    <script>
        // --- 3D ë°°ê²½ ì”¬ ---
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.getElementById('scene-container').appendChild(renderer.domElement);
        
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.8);
        scene.add(ambientLight);
        const directionalLight = new THREE.DirectionalLight(0xffffff, 0.6);
        directionalLight.position.set(5, 10, 7.5);
        scene.add(directionalLight);
        camera.position.z = 5;

        let scalesOfJustice = null;

        function createScalesOfJustice() {
            const group = new THREE.Group();
            const beamMaterial = new THREE.MeshStandardMaterial({ color: 0x3498db, metalness: 0.7, roughness: 0.3 });
            const baseMaterial = new THREE.MeshStandardMaterial({ color: 0x7f8c8d, metalness: 0.5, roughness: 0.6 });
            const base = new THREE.Mesh(new THREE.CylinderGeometry(0.5, 0.8, 0.3, 32), baseMaterial);
            group.add(base);
            const stand = new THREE.Mesh(new THREE.CylinderGeometry(0.1, 0.1, 3, 32), baseMaterial);
            stand.position.y = 1.65;
            group.add(stand);
            const beam = new THREE.Mesh(new THREE.BoxGeometry(3, 0.1, 0.1), beamMaterial);
            beam.position.y = 3.2;
            group.add(beam);
            for (let i = -1; i <= 1; i += 2) {
                const pan = new THREE.Mesh(new THREE.CylinderGeometry(0.6, 0.5, 0.05, 32), beamMaterial);
                pan.position.set(i * 1.2, 2.2, 0);
                group.add(pan);
                const lineMaterial = new THREE.LineBasicMaterial({ color: 0x3498db });
                const points = [ new THREE.Vector3(i * 1.4, 3.2, 0), new THREE.Vector3(i * 1.2, 2.25, 0) ];
                const line = new THREE.Line(new THREE.BufferGeometry().setFromPoints(points), lineMaterial);
                group.add(line);
            }
            group.visible = false;
            scene.add(group);
            return group;
        }

        scalesOfJustice = createScalesOfJustice();

        function animate3D() {
            requestAnimationFrame(animate3D);
            if (scalesOfJustice && scalesOfJustice.visible) {
                scalesOfJustice.rotation.y += 0.005;
            }
            renderer.render(scene, camera);
        }
        animate3D();

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        // --- ì‹œë‚˜ë¦¬ì˜¤ ë°ì´í„° ---
        const ALL_SCENARIOS = {
            easy: [
                { text: "í”¼ìƒì†ì¸ AëŠ” ë°°ìš°ì B, ìë…€ Cë¥¼ ë‚¨ê¸°ê³  30ì–µì›ì˜ ì¬ì‚°ì„ ë‚¨ê¸´ ì±„ ì‚¬ë§í–ˆìŠµë‹ˆë‹¤. ìƒì†ì¸ì€ ëˆ„êµ¬ì´ë©°, ê°ìì˜ ìƒì†ì•¡ì€ ì–¼ë§ˆì¼ê¹Œìš”?", characters: ["ë°°ìš°ì B", "ìë…€ C", "Aì˜ ì¹œêµ¬"], solution: { amounts: {"ë°°ìš°ì B": 1800000000, "ìë…€ C": 1200000000} }, explanation: "1ìˆœìœ„ ìƒì†ì¸ì€ ë°°ìš°ìì™€ ì§ê³„ë¹„ì†(ìë…€)ì…ë‹ˆë‹¤. ì¹œêµ¬ëŠ” ìƒì†ê¶Œì´ ì—†ìŠµë‹ˆë‹¤. ë°°ìš°ìëŠ” ì§ê³„ë¹„ì† ìƒì†ë¶„ì˜ 1.5ë°°ë¥¼ ë°›ìœ¼ë¯€ë¡œ, ìƒì† ë¹„ìœ¨ì€ B:C = 1.5:1 ì…ë‹ˆë‹¤. ë”°ë¼ì„œ BëŠ” 18ì–µ, CëŠ” 12ì–µì„ ìƒì†ë°›ìŠµë‹ˆë‹¤." },
                { text: "í”¼ìƒì†ì¸ AëŠ” ë¯¸í˜¼ìœ¼ë¡œ ìë…€ê°€ ì—†ìœ¼ë©°, ë¶€ëª¨ë‹˜ B, Cê°€ ëª¨ë‘ ìƒì¡´í•´ ê³„ì‹­ë‹ˆë‹¤. Aê°€ ë‚¨ê¸´ ì¬ì‚° 20ì–µì›ì€ ì–´ë–»ê²Œ ìƒì†ë ê¹Œìš”?", characters: ["ë¶€ëª¨ë‹˜ B", "ë¶€ëª¨ë‹˜ C", "Aì˜ ì‚¼ì´Œ"], solution: { amounts: {"ë¶€ëª¨ë‹˜ B": 1000000000, "ë¶€ëª¨ë‹˜ C": 1000000000} }, explanation: "1ìˆœìœ„ ìƒì†ì¸(ì§ê³„ë¹„ì†, ë°°ìš°ì)ì´ ì—†ìœ¼ë¯€ë¡œ 2ìˆœìœ„ì¸ ì§ê³„ì¡´ì†(ë¶€ëª¨)ì´ ìƒì†ì¸ì´ ë©ë‹ˆë‹¤. ì‚¼ì´Œì€ í›„ìˆœìœ„ì´ë¯€ë¡œ ìƒì†ê¶Œì´ ì—†ìŠµë‹ˆë‹¤. ë¶€ëª¨ëŠ” ê· ë“±í•˜ê²Œ ìƒì†ë°›ìœ¼ë¯€ë¡œ ê°ê° 10ì–µì”© ìƒì†ë°›ìŠµë‹ˆë‹¤." },
                { text: "í”¼ìƒì†ì¸ AëŠ” ë°°ìš°ì, ìë…€, ë¶€ëª¨ë‹˜ì´ ëª¨ë‘ ì—†ê³  í˜•ì œ B, Cë§Œ ìˆìŠµë‹ˆë‹¤. Aê°€ ë‚¨ê¸´ ì¬ì‚° 10ì–µì›ì€ ì–´ë–»ê²Œ ìƒì†ë ê¹Œìš”?", characters: ["í˜•ì œ B", "í˜•ì œ C", "Bì˜ ìë…€"], solution: { amounts: {"í˜•ì œ B": 500000000, "í˜•ì œ C": 500000000} }, explanation: "1, 2ìˆœìœ„ ìƒì†ì¸ì´ ì—†ìœ¼ë¯€ë¡œ 3ìˆœìœ„ì¸ í˜•ì œìë§¤ê°€ ìƒì†ì¸ì´ ë©ë‹ˆë‹¤. Bì˜ ìë…€(ì¡°ì¹´)ëŠ” Bê°€ ì‚´ì•„ìˆìœ¼ë¯€ë¡œ ìƒì†ê¶Œì´ ì—†ìŠµë‹ˆë‹¤. í˜•ì œ Bì™€ Cê°€ 10ì–µì›ì„ ê· ë“±í•˜ê²Œ ë‚˜ëˆ„ì–´ ê°ê° 5ì–µì”© ìƒì†ë°›ìŠµë‹ˆë‹¤."},
                { text: "í”¼ìƒì†ì¸ AëŠ” ìë…€ B, Cë¥¼ ë‚¨ê¸°ê³  ì‚¬ë§í–ˆìŠµë‹ˆë‹¤. ë°°ìš°ìëŠ” ì—†ìŠµë‹ˆë‹¤. Aì˜ ì¬ì‚° 80ì–µì›ì€ ì–´ë–»ê²Œ ë¶„ë°°ë ê¹Œìš”?", characters: ["ìë…€ B", "ìë…€ C", "Aì˜ ë™ìƒ"], solution: { amounts: {"ìë…€ B": 4000000000, "ìë…€ C": 4000000000} }, explanation: "ìƒì†ì¸ì€ 1ìˆœìœ„ì¸ ì§ê³„ë¹„ì† Bì™€ Cì…ë‹ˆë‹¤. ë™ìƒì€ í›„ìˆœìœ„ì…ë‹ˆë‹¤. ë°°ìš°ìê°€ ì—†ìœ¼ë¯€ë¡œ ìë…€ë“¤ì´ ê· ë“±í•˜ê²Œ ìƒì†ë°›ì•„ ê°ê° 40ì–µì”© ê°–ê²Œ ë©ë‹ˆë‹¤."},
                { text: "í”¼ìƒì†ì¸ AëŠ” ë°°ìš°ì Bë§Œ ìˆê³  ë‹¤ë¥¸ ê°€ì¡±ì€ ì—†ìŠµë‹ˆë‹¤. Aê°€ ë‚¨ê¸´ ì¬ì‚° 150ì–µì›ì€ ëˆ„êµ¬ì—ê²Œ ìƒì†ë ê¹Œìš”?", characters: ["ë°°ìš°ì B", "Aì˜ ì˜¤ëœ ì¹œêµ¬"], solution: { amounts: {"ë°°ìš°ì B": 15000000000} }, explanation: "ì§ê³„ë¹„ì†ê³¼ ì§ê³„ì¡´ì†ì´ ì—†ëŠ” ê²½ìš°, ë°°ìš°ìê°€ ë‹¨ë…ìœ¼ë¡œ ìƒì†ë°›ìŠµë‹ˆë‹¤. ì¹œêµ¬ëŠ” ìƒì†ê¶Œì´ ì—†ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ë°°ìš°ì Bê°€ 150ì–µ ì „ì•¡ì„ ìƒì†ë°›ìŠµë‹ˆë‹¤."}
            ],
            medium: [
                { text: "í”¼ìƒì†ì¸ AëŠ” ë°°ìš°ì Bì™€ ì´í˜¼ í›„, Cì™€ ì¬í˜¼í•˜ì—¬ ì‚´ì•˜ìŠµë‹ˆë‹¤. Aì—ê²ŒëŠ” Bì™€ì˜ ì‚¬ì´ì—ì„œ ë‚³ì€ ìë…€ Dê°€ ìˆìŠµë‹ˆë‹¤. Aê°€ 90ì–µì›ì˜ ì¬ì‚°ì„ ë‚¨ê¸°ê³  ì‚¬ë§í–ˆë‹¤ë©´, ìƒì† ê´€ê³„ëŠ” ì–´ë–»ê²Œ ë ê¹Œìš”?", characters: ["ì „ ë°°ìš°ì B", "í˜„ ë°°ìš°ì C", "ìë…€ D"], solution: { amounts: {"í˜„ ë°°ìš°ì C": 5400000000, "ìë…€ D": 3600000000} }, explanation: "ì´í˜¼í•œ ì „ ë°°ìš°ì BëŠ” ìƒì†ê¶Œì´ ì—†ìŠµë‹ˆë‹¤. ìƒì†ì¸ì€ í˜„ì¬ ë²•ë¥ ìƒ ë°°ìš°ìì¸ Cì™€ ì§ê³„ë¹„ì†ì¸ ìë…€ Dì…ë‹ˆë‹¤. ë°°ìš°ì CëŠ” ìë…€ Dì˜ 1.5ë°°ë¥¼ ìƒì†ë°›ìœ¼ë¯€ë¡œ, CëŠ” 54ì–µ, DëŠ” 36ì–µì„ ìƒì†ë°›ìŠµë‹ˆë‹¤." },
                { text: "í”¼ìƒì†ì¸ Aì—ê²ŒëŠ” ë°°ìš°ì Bê°€ ìˆê³ , BëŠ” í˜„ì¬ Aì˜ ì•„ì´ë¥¼ ì„ì‹  ì¤‘ì…ë‹ˆë‹¤. Aê°€ 50ì–µì›ì˜ ì¬ì‚°ì„ ë‚¨ê¸°ê³  ì‚¬ë§í–ˆë‹¤ë©´, ìƒì†ì€ ì–´ë–»ê²Œ ë ê¹Œìš”? (ë‹¨, íƒœì•„ëŠ” ì‚´ì•„ì„œ ì¶œìƒí–ˆë‹¤ê³  ê°€ì •í•©ë‹ˆë‹¤.)", characters: ["ë°°ìš°ì B", "íƒœì•„", "Aì˜ ì–´ë¨¸ë‹ˆ"], solution: { amounts: {"ë°°ìš°ì B": 3000000000, "íƒœì•„": 2000000000} }, explanation: "ë¯¼ë²•ìƒ íƒœì•„ëŠ” ìƒì† ìˆœìœ„ì— ê´€í•˜ì—¬ ì´ë¯¸ ì¶œìƒí•œ ê²ƒìœ¼ë¡œ ë´…ë‹ˆë‹¤. ë”°ë¼ì„œ ìƒì†ì¸ì€ ë°°ìš°ì Bì™€ íƒœì•„ì…ë‹ˆë‹¤. 1ìˆœìœ„ ìƒì†ì¸ì´ ìˆìœ¼ë¯€ë¡œ 2ìˆœìœ„ì¸ Aì˜ ì–´ë¨¸ë‹ˆëŠ” ìƒì†ê¶Œì´ ì—†ìŠµë‹ˆë‹¤. ìƒì† ë¹„ìœ¨ì€ 1.5:1ì´ë¯€ë¡œ Bê°€ 30ì–µ, íƒœì•„ê°€ 20ì–µì„ ìƒì†ë°›ìŠµë‹ˆë‹¤." },
                { text: "í”¼ìƒì†ì¸ AëŠ” ë²•ë¥ ìƒ ë°°ìš°ì Bì™€ì˜ ì‚¬ì´ì— ìë…€ê°€ ì—†ì—ˆìœ¼ë‚˜, í˜¼ì™¸ì Cë¥¼ ì¸ì§€í•˜ì˜€ìŠµë‹ˆë‹¤. Aê°€ ì‚¬ë§ ì‹œ ë‚¨ê¸´ ì¬ì‚° 200ì–µì›ì€ ëˆ„êµ¬ì—ê²Œ ì–¼ë§ˆë‚˜ ìƒì†ë ê¹Œìš”?", characters: ["ë°°ìš°ì B", "í˜¼ì™¸ì C", "Aì˜ ë™ìƒ"], solution: { amounts: {"ë°°ìš°ì B": 12000000000, "í˜¼ì™¸ì C": 8000000000} }, explanation: "ì¸ì§€ëœ í˜¼ì™¸ì CëŠ” ë²•ë¥ ìƒ ìë…€ì™€ ë™ë“±í•œ ìƒì†ê¶Œì„ ê°€ì§‘ë‹ˆë‹¤. ë”°ë¼ì„œ ìƒì†ì¸ì€ ë°°ìš°ì Bì™€ ì§ê³„ë¹„ì† Cì…ë‹ˆë‹¤. 1ìˆœìœ„ ìƒì†ì¸ì´ ìˆìœ¼ë¯€ë¡œ 3ìˆœìœ„ì¸ Aì˜ ë™ìƒì€ ìƒì†ê¶Œì´ ì—†ìŠµë‹ˆë‹¤. ë°°ìš°ì Bê°€ 1.5, Cê°€ 1ì˜ ë¹„ìœ¨ë¡œ ìƒì†ë°›ì•„ BëŠ” 120ì–µ, CëŠ” 80ì–µì„ ìƒì†ë°›ìŠµë‹ˆë‹¤."},
                { text: "í”¼ìƒì†ì¸ AëŠ” ë°°ìš°ì Bì™€ì˜ ì‚¬ì´ì—ì„œ ìë…€ Cë¥¼ ë‚³ì•˜ê³ , ì´í›„ Dë¥¼ ì…ì–‘í–ˆìŠµë‹ˆë‹¤. Aê°€ 105ì–µì›ì˜ ì¬ì‚°ì„ ë‚¨ê¸°ê³  ì‚¬ë§í–ˆë‹¤ë©´ ìƒì†ì•¡ì€ ì–´ë–»ê²Œ ë ê¹Œìš”?", characters: ["ë°°ìš°ì B", "ìë…€ C", "ì–‘ì D"], solution: { amounts: {"ë°°ìš°ì B": 4500000000, "ìë…€ C": 3000000000, "ì–‘ì D": 3000000000} }, explanation: "ì–‘ìëŠ” ë²•ì ìœ¼ë¡œ ì¹œìì™€ ë™ì¼í•œ ìƒì†ê¶Œì„ ê°€ì§‘ë‹ˆë‹¤. ë”°ë¼ì„œ ìƒì†ì¸ì€ ë°°ìš°ì B, ì¹œì C, ì–‘ì Dì…ë‹ˆë‹¤. ìƒì† ë¹„ìœ¨ì€ B:C:D = 1.5:1:1 ì´ë¯€ë¡œ, BëŠ” 45ì–µ, Cì™€ DëŠ” ê°ê° 30ì–µì”© ìƒì†ë°›ìŠµë‹ˆë‹¤."},
                { text: "í”¼ìƒì†ì¸ AëŠ” ì‚¬ì‹¤í˜¼ ê´€ê³„ì˜ ë°°ìš°ì Bì™€ ì‚´ê³  ìˆìœ¼ë©°, ê·¸ë“¤ ì‚¬ì´ì— ìë…€ Cë¥¼ ë‚³ì•„ ì¸ì§€í–ˆìŠµë‹ˆë‹¤. Aì—ê²ŒëŠ” ë²•ë¥ ìƒ í˜¼ì¸í•œ ì ì´ ì—†ìŠµë‹ˆë‹¤. Aê°€ 100ì–µì›ì˜ ì¬ì‚°ì„ ë‚¨ê¸°ê³  ì‚¬ë§í–ˆë‹¤ë©´ ëˆ„ê°€ ìƒì†ë°›ì„ê¹Œìš”?", characters: ["ì‚¬ì‹¤í˜¼ ë°°ìš°ì B", "ìë…€ C"], solution: { amounts: {"ìë…€ C": 10000000000} }, explanation: "ì‚¬ì‹¤í˜¼ ê´€ê³„ì˜ ë°°ìš°ìëŠ” ë²•ì •ìƒì†ê¶Œì´ ì—†ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì¸ì§€ëœ ìë…€ CëŠ” 1ìˆœìœ„ ìƒì†ì¸ì…ë‹ˆë‹¤. ë”°ë¼ì„œ Cê°€ ë‹¨ë…ìœ¼ë¡œ 100ì–µ ì „ì•¡ì„ ìƒì†ë°›ìŠµë‹ˆë‹¤."}
            ],
            hard: [
                { text: "ììˆ˜ì„±ê°€í•œ ì‚¬ì—…ê°€ ì¡°ì”¨ëŠ” ì „ì²˜ ì•ˆì”¨ì™€ì˜ ì‚¬ì´ì— ì•„ë“¤ ê°‘ì„ ë‘ì—ˆìœ¼ë‚˜ ì´í˜¼í–ˆìŠµë‹ˆë‹¤. ì´í›„ ê±°ë˜ì²˜ì—ì„œ ë§Œë‚œ ì§„ì”¨ì™€ ì˜¤ëœ ê¸°ê°„ êµì œí•˜ë©° ë”¸ ì„ì„ ë‚³ì•„ ì¸ì§€í–ˆê³ , ê²°êµ­ ì§„ì”¨ì™€ ì¬í˜¼í–ˆìŠµë‹ˆë‹¤. ì§„ì”¨ëŠ” ì „ ë‚¨í¸ê³¼ì˜ ì‚¬ì´ì—ì„œ ë‚³ì€ ë³‘ê³¼ ì •ì„ ë°ë ¤ì™”ê³ , ì¡°ì”¨ëŠ” ì´ë“¤ì„ ëª¨ë‘ ì…ì–‘í–ˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì•„ë“¤ ì •ì€ 'ì•„ë²„ì§€ê°€ ë‘˜ì¼ ìˆ˜ ì—†ë‹¤'ë©° íŒŒì–‘ì„ ì‹ ì²­í•˜ì—¬ ì ˆì°¨ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ìµœê·¼ ì¡°ì”¨ê°€ ì—¬í–‰ ì¤‘ ë¶ˆì˜ì˜ ì‚¬ê³ ë¡œ ì‚¬ë§í•˜ì˜€ìœ¼ë©°, 252ì–µì›ì˜ í˜„ê¸ˆì„ ë‚¨ê²¼ìŠµë‹ˆë‹¤. ìƒì†ì¸ê³¼ ê°ìì˜ ìƒì†ì•¡ì„ ê²°ì •í•˜ì„¸ìš”.", characters: ["ì „ì²˜ ì•ˆì”¨", "í˜„ ë°°ìš°ì ì§„ì”¨", "ì•„ë“¤ ê°‘", "ë”¸ ì„", "ì–‘ì ë³‘", "íŒŒì–‘ëœ ì •"], solution: { amounts: {"í˜„ ë°°ìš°ì ì§„ì”¨": 8400000000, "ì•„ë“¤ ê°‘": 5600000000, "ë”¸ ì„": 5600000000, "ì–‘ì ë³‘": 5600000000} }, explanation: "1. ìƒì†ê¶Œì í™•ì •: ì „ì²˜ ì•ˆì”¨(ì´í˜¼), íŒŒì–‘ëœ ì •ì€ ìƒì†ê¶Œì´ ì—†ìŠµë‹ˆë‹¤. 1ìˆœìœ„ ìƒì†ì¸ì€ í˜„ ë°°ìš°ì ì§„ì”¨ì™€ ì§ê³„ë¹„ì†ì¸ ì•„ë“¤ ê°‘, ì¸ì§€ëœ í˜¼ì™¸ì ì„, ì–‘ì ë³‘ì…ë‹ˆë‹¤.\n2. ìƒì†ë¶„ ê³„ì‚°: ë°°ìš°ìëŠ” ìë…€ì˜ 1.5ë°°ë¥¼ ìƒì†ë°›ìŠµë‹ˆë‹¤. ìƒì† ë¹„ìœ¨ì€ ì§„ì”¨:ê°‘:ì„:ë³‘ = 1.5:1:1:1 ì…ë‹ˆë‹¤. ì´ 4.5 ì§€ë¶„ìœ¼ë¡œ 252ì–µì›ì„ ë‚˜ëˆ•ë‹ˆë‹¤. 1ì§€ë¶„ì€ 56ì–µì›(252ì–µ/4.5)ì…ë‹ˆë‹¤. ë”°ë¼ì„œ ì§„ì”¨ëŠ” 84ì–µ(56ì–µ*1.5), ê°‘,ì„,ë³‘ì€ ê°ê° 56ì–µì”© ìƒì†ë°›ìŠµë‹ˆë‹¤." },
                { text: "ë¶€ì AëŠ” 'ì „ ì¬ì‚° 140ì–µì„ ìë…€ Cì—ê²Œ ë¬¼ë ¤ì¤€ë‹¤'ëŠ” ìœ íš¨í•œ ìœ ì–¸ì„ ë‚¨ê¸°ê³  ì‚¬ë§í–ˆìŠµë‹ˆë‹¤. Aì—ê²ŒëŠ” ì´í˜¼í•œ ì „ì²˜ì™€ì˜ ìë…€ C ì™¸ì—, ì‚¬ì‹¤í˜¼ ê´€ê³„ì—ì„œ ë‚³ì•„ ì¸ì§€í•œ ìë…€ Eê°€ ìˆìŠµë‹ˆë‹¤. ì´ ê²½ìš° ê° ì¸ë¬¼ë“¤ì´ ìµœì¢…ì ìœ¼ë¡œ ë°›ê²Œ ë  ê¸ˆì•¡ì€ ì–¼ë§ˆì¼ê¹Œìš”? (ë‹¨, EëŠ” ìœ ë¥˜ë¶„ì„ ì²­êµ¬í•œë‹¤ê³  ê°€ì •í•©ë‹ˆë‹¤.)", characters: ["ìë…€ C", "ìë…€ E", "Aì˜ ì‚¬ì‹¤í˜¼ ë°°ìš°ì"], solution: { amounts: {"ìë…€ C": 10500000000, "ìë…€ E": 3500000000} }, explanation: "ì‚¬ì‹¤í˜¼ ë°°ìš°ìëŠ” ìƒì†ê¶Œì´ ì—†ìŠµë‹ˆë‹¤. ìœ ì–¸ì— ë”°ë¼ Cê°€ 140ì–µ ì „ì•¡ì„ ìƒì†ë°›ì§€ë§Œ, ë˜ ë‹¤ë¥¸ ìƒì†ì¸ EëŠ” ìœ ë¥˜ë¶„ì„ ì²­êµ¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. Eì˜ ë²•ì •ìƒì†ë¶„ì€ 70ì–µ(140ì–µ/2)ì´ë©°, ìœ ë¥˜ë¶„ì€ ê·¸ ì ˆë°˜ì¸ 35ì–µì›ì…ë‹ˆë‹¤. ë”°ë¼ì„œ Eê°€ ìœ ë¥˜ë¶„ì„ ì²­êµ¬í•˜ë©´, ìµœì¢…ì ìœ¼ë¡œ CëŠ” 105ì–µ(140ì–µ - 35ì–µ), EëŠ” 35ì–µì„ ë°›ê²Œ ë©ë‹ˆë‹¤." },
                { text: "í”¼ìƒì†ì¸ ê°‘(ç”²)ì—ê²ŒëŠ” ë°°ìš°ì ì„(ä¹™)ê³¼ ì•„ë“¤ ë³‘(ä¸™), ë”¸ ì •(ä¸)ì´ ìˆìŠµë‹ˆë‹¤. ì•„ë“¤ ë³‘ì€ ë¬´(æˆŠ)ì™€ ê²°í˜¼í•˜ì—¬ ì†ì ê¸°(å·±)ë¥¼ ë‚³ì•˜ìŠµë‹ˆë‹¤. ê·¸ëŸ°ë° ì•„ë“¤ ë³‘ì´ ì•„ë²„ì§€ ê°‘ë³´ë‹¤ ë¨¼ì € êµí†µì‚¬ê³ ë¡œ ì‚¬ë§í–ˆìŠµë‹ˆë‹¤. ëª‡ ë…„ í›„, ê°‘ì´ 210ì–µì›ì˜ ì¬ì‚°ì„ ë‚¨ê¸°ê³  ì‚¬ë§í–ˆìŠµë‹ˆë‹¤. ì´ ê²½ìš° ìƒì†ì€ ì–´ë–»ê²Œ ì´ë£¨ì–´ì§ˆê¹Œìš”?", characters: ["ë°°ìš°ì ì„", "ë”¸ ì •", "ë©°ëŠë¦¬ ë¬´", "ì†ì ê¸°"], solution: { amounts: {"ë°°ìš°ì ì„": 9000000000, "ë”¸ ì •": 6000000000, "ë©°ëŠë¦¬ ë¬´": 3600000000, "ì†ì ê¸°": 2400000000} }, explanation: "ì´ ì‚¬ë¡€ëŠ” 'ëŒ€ìŠµìƒì†'ì— í•´ë‹¹í•©ë‹ˆë‹¤. ìƒì†ì¸ì´ ë  ì•„ë“¤ ë³‘ì´ ë¨¼ì € ì‚¬ë§í–ˆìœ¼ë¯€ë¡œ, ê·¸ì˜ ë°°ìš°ì(ë©°ëŠë¦¬ ë¬´)ì™€ ì§ê³„ë¹„ì†(ì†ì ê¸°)ì´ ê·¸ì˜ ìƒì†ë¶„ì„ ê³µë™ìœ¼ë¡œ ëŒ€ìŠµìƒì†í•©ë‹ˆë‹¤. ìƒì†ì¸ë“¤ì€ ê°‘ì˜ ë°°ìš°ì ì„, ë”¸ ì •, ê·¸ë¦¬ê³  [ë©°ëŠë¦¬ ë¬´ì™€ ì†ì ê¸°]ê°€ ë©ë‹ˆë‹¤. ìƒì†ë¹„ìœ¨ì€ ì„:ì •:[ë³‘ì˜ ì§€ìœ„] = 1.5:1:1 ì…ë‹ˆë‹¤. 1ì§€ë¶„ì€ 60ì–µ(210ì–µ/3.5)ì…ë‹ˆë‹¤. ë”°ë¼ì„œ ì„ì€ 90ì–µ, ì •ì€ 60ì–µ, [ë³‘ì˜ ì§€ìœ„]ëŠ” 60ì–µì…ë‹ˆë‹¤. ì´ 60ì–µì„ ë©°ëŠë¦¬ ë¬´ì™€ ì†ì ê¸°ê°€ 1.5:1ì˜ ë¹„ìœ¨ë¡œ ë‚˜ëˆ„ë¯€ë¡œ, ë¬´ëŠ” 36ì–µ, ê¸°ëŠ” 24ì–µì„ ìƒì†ë°›ìŠµë‹ˆë‹¤." },
                { text: "í”¼ìƒì†ì¸ AëŠ” ë°°ìš°ì Bì™€ ìë…€ Cê°€ ìˆìŠµë‹ˆë‹¤. AëŠ” 'ë‚´ ì¬ì‚° 120ì–µ ì „ë¶€ë¥¼ ë‚´ ì˜¤ëœ ì¹œêµ¬ Dì—ê²Œ ì¤€ë‹¤'ëŠ” ìœ ì–¸ì„ ë‚¨ê¸°ê³  ì‚¬ë§í–ˆìŠµë‹ˆë‹¤. Bì™€ CëŠ” ìœ ë¥˜ë¶„ì„ ì²­êµ¬í•˜ê¸°ë¡œ í–ˆìŠµë‹ˆë‹¤. ìµœì¢…ì ìœ¼ë¡œ Bì™€ CëŠ” ì–¼ë§ˆì”© ë°›ì„ ìˆ˜ ìˆì„ê¹Œìš”?", characters: ["ë°°ìš°ì B", "ìë…€ C", "ì¹œêµ¬ D"], solution: { amounts: {"ë°°ìš°ì B": 3600000000, "ìë…€ C": 2400000000} }, explanation: "ìœ ì–¸ì— ë”°ë¼ ì¹œêµ¬ Dê°€ ì „ ì¬ì‚°ì„ ë°›ì§€ë§Œ, ìƒì†ì¸ Bì™€ CëŠ” ìœ ë¥˜ë¶„ì„ ì²­êµ¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë²•ì •ìƒì†ë¶„ì€ Bê°€ 72ì–µ, Cê°€ 48ì–µì…ë‹ˆë‹¤. ìœ ë¥˜ë¶„ì€ ë²•ì •ìƒì†ë¶„ì˜ 1/2ì´ë¯€ë¡œ, BëŠ” 36ì–µ, CëŠ” 24ì–µì„ Dì—ê²Œ ë°˜í™˜ ì²­êµ¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤." },
                { text: "í”¼ìƒì†ì¸ Aì™€ ê·¸ì˜ ìœ ì¼í•œ ìë…€ BëŠ” ê°™ì€ ë¹„í–‰ê¸° ì‚¬ê³ ë¡œ ì‚¬ë§í–ˆìŠµë‹ˆë‹¤. Aì—ê²ŒëŠ” ë°°ìš°ì Cì™€ ìƒì¡´í•œ ë¶€ëª¨ë‹˜ F, Gê°€ ìˆìŠµë‹ˆë‹¤. Aì˜ ì¬ì‚° 210ì–µì›ì€ ì–´ë–»ê²Œ ë¶„ë°°ë ê¹Œìš”?", characters: ["ë°°ìš°ì C", "ë¶€ëª¨ë‹˜ F", "ë¶€ëª¨ë‹˜ G"], solution: { amounts: {"ë°°ìš°ì C": 9000000000, "ë¶€ëª¨ë‹˜ F": 6000000000, "ë¶€ëª¨ë‹˜ G": 6000000000} }, explanation: "ë™ì‹œì‚¬ë§ ì¶”ì •ì— ë”°ë¼ ìë…€ BëŠ” ìƒì†ì¸ì´ ë  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ìƒì†ì¸ì€ 1ìˆœìœ„ ì§ê³„ë¹„ì†ì´ ì—†ëŠ” ìƒíƒœì´ë¯€ë¡œ, ë°°ìš°ì Cì™€ 2ìˆœìœ„ì¸ ë¶€ëª¨ë‹˜ F, Gê°€ ê³µë™ìƒì†ì¸ì´ ë©ë‹ˆë‹¤. ìƒì†ë¹„ìœ¨ì€ C:F:G = 1.5:1:1 ì…ë‹ˆë‹¤. ë”°ë¼ì„œ CëŠ” 90ì–µ, ë¶€ëª¨ë‹˜ F, GëŠ” ê°ê° 60ì–µì„ ìƒì†ë°›ìŠµë‹ˆë‹¤." }
            ],
            very_hard: [
                { text: "í”¼ìƒì†ì¸ A(ì¬ì‚° 700ì–µ)ëŠ” 'ì „ ì¬ì‚°ì„ ì‚¬íšŒì— ê¸°ë¶€í•œë‹¤'ëŠ” ìœ ì–¸ì„ ë‚¨ê¸°ê³  ì‚¬ë§í–ˆìŠµë‹ˆë‹¤. Aì—ê²ŒëŠ” ë°°ìš°ì B, ê·¸ë¦¬ê³  ë¨¼ì € ì‚¬ë§í•œ ì•„ë“¤ Cê°€ ìˆìŠµë‹ˆë‹¤. Cì—ê²ŒëŠ” ë°°ìš°ì Dì™€ ì•„ë“¤ Eê°€ ìˆìŠµë‹ˆë‹¤. ìƒì†ì¸ë“¤ì€ ëª¨ë‘ ìœ ë¥˜ë¶„ì„ ì²­êµ¬í•˜ê¸°ë¡œ í–ˆìŠµë‹ˆë‹¤. ìµœì¢…ì ìœ¼ë¡œ ê°ìëŠ” ì–¼ë§ˆë¥¼ ë°›ì„ ìˆ˜ ìˆì„ê¹Œìš”?", characters: ["ë°°ìš°ì B", "Cì˜ ë°°ìš°ì D", "Cì˜ ì•„ë“¤ E", "ì‚¬íšŒë³µì§€ì¬ë‹¨"], solution: { amounts: {"ë°°ìš°ì B": 21000000000, "Cì˜ ë°°ìš°ì D": 8400000000, "Cì˜ ì•„ë“¤ E": 5600000000, "ì‚¬íšŒë³µì§€ì¬ë‹¨": 35000000000} }, explanation: "ìœ ì–¸ìœ¼ë¡œ ìƒì†ì„ ëª» ë°›ì€ ìƒì†ì¸ë“¤ì€ ìœ ë¥˜ë¶„ì„ ì²­êµ¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 1. ë²•ì •ìƒì†ë¶„ ê³„ì‚°: Bì™€ Cê°€ ìƒì†í–ˆë‹¤ë©´ B:C=1.5:1, ì¦‰ Bê°€ 420ì–µ, Cê°€ 280ì–µì„ ë°›ì•˜ì„ ê²ƒì…ë‹ˆë‹¤. 2. ìœ ë¥˜ë¶„ ê³„ì‚°: ìœ ë¥˜ë¶„ì€ ë²•ì •ìƒì†ë¶„ì˜ 1/2ì…ë‹ˆë‹¤. Bì˜ ìœ ë¥˜ë¶„ì€ 210ì–µ, Cì˜ ìœ ë¥˜ë¶„ì€ 140ì–µì…ë‹ˆë‹¤. 3. ëŒ€ìŠµìƒì† ì ìš©: CëŠ” ì‚¬ë§í–ˆìœ¼ë¯€ë¡œ Cì˜ ìœ ë¥˜ë¶„ 140ì–µì„ ê·¸ì˜ ìƒì†ì¸ Dì™€ Eê°€ ëŒ€ìŠµìƒì†í•©ë‹ˆë‹¤. D:E=1.5:1 ë¹„ìœ¨ë¡œ ë‚˜ëˆ„ë¯€ë¡œ, DëŠ” 84ì–µ, EëŠ” 56ì–µì„ ë°›ìŠµë‹ˆë‹¤. ì‚¬íšŒë³µì§€ì¬ë‹¨ì€ 700ì–µì—ì„œ ìœ ë¥˜ë¶„ ì´ì•¡ 350ì–µì„ ëº€ 350ì–µì„ ë°›ìŠµë‹ˆë‹¤." },
                { text: "í”¼ìƒì†ì¸ Aì™€ ê·¸ì˜ ì•„ë‚´ BëŠ” ìë…€ ì—†ì´ ë¹„í–‰ê¸° ì‚¬ê³ ë¡œ ë™ì‹œì— ì‚¬ë§í–ˆìŠµë‹ˆë‹¤. Aì—ê²ŒëŠ” 300ì–µì›ì˜ ì¬ì‚°ê³¼ ìƒì¡´í•œ ë¶€ëª¨ë‹˜ì´ ìˆê³ , Bì—ê²ŒëŠ” 100ì–µì›ì˜ ì¬ì‚°ê³¼ ìƒì¡´í•œ ì˜¤ë¹ ê°€ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ°ë° Aì—ê²ŒëŠ” ì‚¬ì‹¤í˜¼ ê´€ê³„ì˜ ë°°ìš°ì Cì™€ ê·¸ ì‚¬ì´ì—ì„œ ë‚³ì•„ ì¸ì§€í•œ ì•„ë“¤ Dë„ ìˆì—ˆìŠµë‹ˆë‹¤. ê°ìì˜ ì¬ì‚°ì€ ì–´ë–»ê²Œ ë ê¹Œìš”?", characters: ["Aì˜ ì•„ë“¤ D", "Bì˜ ì˜¤ë¹ ", "Aì˜ ë¶€ëª¨ë‹˜", "ì‚¬ì‹¤í˜¼ ë°°ìš°ì C"], solution: { amounts: {"Aì˜ ì•„ë“¤ D": 30000000000, "Bì˜ ì˜¤ë¹ ": 10000000000} }, explanation: "ë™ì‹œì‚¬ë§ìœ¼ë¡œ Aì™€ BëŠ” ì„œë¡œ ìƒì†í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. Aì˜ ì¬ì‚° 300ì–µì›ì€ 1ìˆœìœ„ ìƒì†ì¸ì¸ ì§ê³„ë¹„ì†(ì•„ë“¤ D)ì—ê²Œ ëª¨ë‘ ìƒì†ë©ë‹ˆë‹¤. Aì˜ ë¶€ëª¨ë‹˜ê³¼ ì‚¬ì‹¤í˜¼ ë°°ìš°ì CëŠ” ìƒì†ê¶Œì´ ì—†ìŠµë‹ˆë‹¤. Bì˜ ì¬ì‚° 100ì–µì›ì€ 1,2ìˆœìœ„ ìƒì†ì¸ì´ ì—†ìœ¼ë¯€ë¡œ 3ìˆœìœ„ì¸ í˜•ì œìë§¤(ì˜¤ë¹ )ì—ê²Œ ëª¨ë‘ ìƒì†ë©ë‹ˆë‹¤." },
                { text: "í”¼ìƒì†ì¸ A(ì¬ì‚° 700ì–µ)ëŠ” 'ì•„ë“¤ Cì—ê²Œ ì „ ì¬ì‚°ì„ ë¬¼ë ¤ì¤€ë‹¤'ëŠ” ìœ ì–¸ì„ ë‚¨ê¸°ê³  ì‚¬ë§í–ˆìŠµë‹ˆë‹¤. Aì—ê²ŒëŠ” ë°°ìš°ì B, ì•„ë“¤ C, ë”¸ Dê°€ ìˆìŠµë‹ˆë‹¤. Bì™€ DëŠ” ìœ ë¥˜ë¶„ì„ ì²­êµ¬í•˜ê¸°ë¡œ í–ˆìŠµë‹ˆë‹¤. ìµœì¢… ìƒì†ì•¡ì€ ì–´ë–»ê²Œ ë ê¹Œìš”?", characters: ["ë°°ìš°ì B", "ì•„ë“¤ C", "ë”¸ D"], solution: { amounts: {"ë°°ìš°ì B": 15000000000, "ì•„ë“¤ C": 45000000000, "ë”¸ D": 10000000000} }, explanation: "1. ë²•ì •ìƒì†ë¶„(700ì–µ ê¸°ì¤€): B:C:D=1.5:1:1. B=300ì–µ, C=200ì–µ, D=200ì–µ. 2. ìœ ë¥˜ë¶„: Bì˜ ìœ ë¥˜ë¶„ì€ 150ì–µ, Dì˜ ìœ ë¥˜ë¶„ì€ 100ì–µì…ë‹ˆë‹¤. 3. ìœ ë¥˜ë¶„ ë°˜í™˜: CëŠ” ìœ ì–¸ìœ¼ë¡œ 700ì–µì„ ë°›ì•˜ìŠµë‹ˆë‹¤. Bì™€ DëŠ” ìœ ë¥˜ë¶„ ë¶€ì¡±ì•¡(ê°ê° 150ì–µ, 100ì–µ)ì„ Cì—ê²Œ ì²­êµ¬í•©ë‹ˆë‹¤. 4. ìµœì¢…: B=150ì–µ, D=100ì–µ. C=700ì–µ-150ì–µ-100ì–µ=450ì–µ." },
                { text: "í”¼ìƒì†ì¸ A(ì¬ì‚° 700ì–µ)ì™€ ê·¸ì˜ ì•„ë“¤ CëŠ” ê°™ì€ ì‚¬ê³ ë¡œ ë™ì‹œì— ì‚¬ë§í–ˆìŠµë‹ˆë‹¤. Aì—ê²ŒëŠ” ë°°ìš°ì Bì™€ ë”¸ Dê°€ ìˆìŠµë‹ˆë‹¤. Cì—ê²ŒëŠ” ë°°ìš°ì Eì™€ ì•„ë“¤ Fê°€ ìˆìŠµë‹ˆë‹¤. Aì˜ ì¬ì‚°ì€ ì–´ë–»ê²Œ ë¶„ë°°ë ê¹Œìš”?", characters: ["ë°°ìš°ì B", "ë”¸ D", "Cì˜ ë°°ìš°ì E", "Cì˜ ì•„ë“¤ F"], solution: { amounts: {"ë°°ìš°ì B": 30000000000, "ë”¸ D": 20000000000, "Cì˜ ë°°ìš°ì E": 12000000000, "Cì˜ ì•„ë“¤ F": 8000000000} }, explanation: "ë™ì‹œì‚¬ë§ì˜ ê²½ìš°ì—ë„ ëŒ€ìŠµìƒì†ì´ ì¸ì •ë©ë‹ˆë‹¤. ë”°ë¼ì„œ Aì˜ ìƒì†ì¸ì€ ë°°ìš°ì B, ë”¸ D, ê·¸ë¦¬ê³  Cì˜ ì§€ìœ„ë¥¼ ëŒ€ìŠµìƒì†í•˜ëŠ” Eì™€ Fì…ë‹ˆë‹¤. ìƒì†ë¹„ìœ¨ì€ B:D:[Cì˜ ì§€ìœ„] = 1.5:1:1 ì…ë‹ˆë‹¤. 1ì§€ë¶„ì€ 200ì–µ(700ì–µ/3.5)ì…ë‹ˆë‹¤. ë”°ë¼ì„œ BëŠ” 300ì–µ, DëŠ” 200ì–µ, [Cì˜ ì§€ìœ„]ëŠ” 200ì–µì…ë‹ˆë‹¤. ì´ 200ì–µì„ Cì˜ ë°°ìš°ì Eì™€ ìë…€ Fê°€ 1.5:1ì˜ ë¹„ìœ¨ë¡œ ë‚˜ëˆ„ë¯€ë¡œ, EëŠ” 120ì–µ, FëŠ” 80ì–µì„ ìƒì†ë°›ìŠµë‹ˆë‹¤." },
                { text: "í”¼ìƒì†ì¸ A(ì¬ì‚° 300ì–µ)ì—ê²ŒëŠ” ë°°ìš°ì B, ì•„ë“¤ C(Aë³´ë‹¤ ë¨¼ì € ì‚¬ë§), ë”¸ Dê°€ ìˆìŠµë‹ˆë‹¤. Cì—ê²ŒëŠ” ë°°ìš°ì Eì™€ ìë…€ Fê°€ ìˆìŠµë‹ˆë‹¤. A ì‚¬ë§ í›„, ë”¸ DëŠ” ë²•ì›ì— ìƒì† í¬ê¸°ë¥¼ ì‹ ê³ í–ˆìŠµë‹ˆë‹¤. ìµœì¢… ìƒì†ì•¡ì€ ì–´ë–»ê²Œ ë ê¹Œìš”?", characters: ["ë°°ìš°ì B", "ë”¸ D", "Cì˜ ë°°ìš°ì E", "Cì˜ ìë…€ F"], solution: { amounts: {"ë°°ìš°ì B": 18000000000, "Cì˜ ë°°ìš°ì E": 7200000000, "Cì˜ ìë…€ F": 4800000000} }, explanation: "ìƒì†ì¸ Dê°€ ìƒì†ì„ í¬ê¸°í•˜ë©´, ê·¸ì˜ ìƒì†ë¶„ì€ ë‹¤ë¥¸ ê³µë™ìƒì†ì¸(B, C)ì—ê²Œ ë²•ì •ìƒì†ë¶„ ë¹„ìœ¨ë¡œ ê·€ì†ë©ë‹ˆë‹¤. CëŠ” ì´ë¯¸ ì‚¬ë§í–ˆìœ¼ë¯€ë¡œ Cì˜ ëŒ€ìŠµìƒì†ì¸(E, F)ì´ ê·¸ ì§€ìœ„ë¥¼ ìŠ¹ê³„í•©ë‹ˆë‹¤. ë”°ë¼ì„œ í¬ê¸°ëœ Dì˜ ì§€ë¶„ì€ Bì™€ [E,F]ì—ê²Œ 1.5:1ì˜ ë¹„ìœ¨ë¡œ ë”í•´ì§‘ë‹ˆë‹¤. ìµœì¢…ì ìœ¼ë¡œ ìƒì†ë¹„ìœ¨ì€ B:C(ëŒ€ìŠµ) = 1.5:1ì´ ë˜ê³ , Aì˜ ì¬ì‚° 300ì–µì›ì€ Bê°€ 180ì–µ, Cì˜ ìƒì†ë¶„ 120ì–µì„ Eì™€ Fê°€ 1.5:1ë¡œ ë‚˜ëˆ„ì–´ Eê°€ 72ì–µ, Fê°€ 48ì–µì„ ìƒì†ë°›ìŠµë‹ˆë‹¤."}
            ]
        };

        // --- ì‹œë®¬ë ˆì´í„° í•µì‹¬ ë¡œì§ ---
        let currentScore = 0;
        let currentDifficulty = '';
        let currentScenario = {};
        let usedIndices = new Set();
        let scenariosForDifficulty = [];
        let selectedCard = null;
        let isFirstAttempt = true;

        const difficultySelector = document.getElementById('difficulty-selector');
        const simulatorMain = document.getElementById('simulator-main');
        const simulatorTitle = document.getElementById('simulator-title');
        const scoreDisplay = document.getElementById('score-display');
        const scenarioText = document.getElementById('scenario-text');
        const heirDropZonesContainer = document.getElementById('heir-drop-zones');
        const cardHolder = document.getElementById('card-holder');
        const amountInput = document.getElementById('amount-input');
        const amountCardPool = document.getElementById('amount-card-pool');
        const createCardBtn = document.getElementById('create-card-btn');
        const submitBtn = document.getElementById('submit-btn');
        const nextBtn = document.getElementById('next-btn');
        const backBtn = document.getElementById('back-btn');
        const answerModal = document.getElementById('answer-modal');
        const modalResult = document.getElementById('modal-result');
        const modalExplanation = document.getElementById('modal-explanation');

        const add10MBtn = document.getElementById('add-10m-btn');
        const add100MBtn = document.getElementById('add-100m-btn');
        const add1BBtn = document.getElementById('add-1b-btn');
        const clearAmountBtn = document.getElementById('clear-amount-btn');
        const howToUseBtn = document.getElementById('how-to-use-btn');
        const howToUseModal = document.getElementById('how-to-use-modal');
        
        function showDifficultyScreen() {
            difficultySelector.style.display = 'flex';
            simulatorMain.style.display = 'none';
            if (scalesOfJustice) scalesOfJustice.visible = false;
        }

        function showSimulatorScreen(difficulty) {
            currentDifficulty = difficulty;
            const difficultyKorean = {easy: 'ì‰¬ì›€', medium: 'ì¤‘ê°„', hard: 'ì–´ë ¤ì›€', very_hard: 'ë§¤ìš° ì–´ë ¤ì›€'};
            simulatorTitle.textContent = `ì‚¬ë¡€ ë¶„ì„ (${difficultyKorean[difficulty]})`;
            scenariosForDifficulty = ALL_SCENARIOS[currentDifficulty];
            usedIndices.clear();
            currentScore = 0;
            scoreDisplay.textContent = `ì ìˆ˜: ${currentScore}`;
            difficultySelector.style.display = 'none';
            simulatorMain.style.display = 'block';
            if (scalesOfJustice) scalesOfJustice.visible = true;
            loadScenario();
        }
        
        function parseAmount(inputStr) {
            if (!inputStr || typeof inputStr !== 'string') return 0;
            let tempStr = inputStr.trim().replace(/,|ì›|\s/g, '');
            let total = 0;

            const units = [
                { key: 'ì¡°', val: 1000000000000 },
                { key: 'ì–µ', val: 100000000 },
                { key: 'ë§Œ', val: 10000 }
            ];

            const koreanNumMap = { 'ì¼': 1, 'ì´': 2, 'ì‚¼': 3, 'ì‚¬': 4, 'ì˜¤': 5, 'ìœ¡': 6, 'ì¹ ': 7, 'íŒ”': 8, 'êµ¬': 9, 'ì‹­': 10 };
            const koreanUnitMap = { 'ì‹­': 10, 'ë°±': 100, 'ì²œ': 1000 };

            tempStr = tempStr.replace(/[ì¼ì´ì‚¼ì‚¬ì˜¤ìœ¡ì¹ íŒ”êµ¬ì‹­ë°±ì²œ]+/g, (match) => {
                let num = 0;
                let temp = 0;
                if (match.startsWith('ì‹­')) match = 'ì¼' + match;
                for (let i = 0; i < match.length; i++) {
                    const char = match[i];
                    if (koreanUnitMap[char]) {
                        num += (temp || 1) * koreanUnitMap[char];
                        temp = 0;
                    } else if (koreanNumMap[char]) {
                        temp = koreanNumMap[char];
                    }
                }
                return num + temp;
            });
            
            tempStr = tempStr.replace(/\s/g, '');

            for (const unit of units) {
                const parts = tempStr.split(unit.key);
                if (parts.length > 1) {
                    if (parts[0] && !isNaN(parts[0])) {
                        total += parseFloat(parts[0]) * unit.val;
                    }
                    tempStr = parts.slice(1).join(unit.key) || '';
                }
            }

            if (tempStr && !isNaN(tempStr)) {
                total += parseFloat(tempStr);
            }
            
            return total;
        }
        
        function formatAmount(number) {
            if (number === 0) return "";
            const eok = Math.floor(number / 100000000);
            const man = Math.floor((number % 100000000) / 10000);
            let str = "";
            if (eok > 0) str += `${eok}ì–µ`;
            if (man > 0) str += ` ${man}ë§Œ`;
            return str.trim();
        }

        function numberToKorean(number) {
            const units = ['', 'ë§Œ', 'ì–µ', 'ì¡°'];
            const smallUnits = ['', 'ì‹­', 'ë°±', 'ì²œ'];
            const numChars = ['ì˜', 'ì¼', 'ì´', 'ì‚¼', 'ì‚¬', 'ì˜¤', 'ìœ¡', 'ì¹ ', 'íŒ”', 'êµ¬'];
            let result = '';
            let unitIndex = 0;
            if (number === 0) return 'ì˜ì›';
            while (number > 0) {
                const part = number % 10000;
                if (part > 0) {
                    let partStr = '';
                    for (let i = 0; i < 4; i++) {
                        const digit = Math.floor(part / (10**i)) % 10;
                        if (digit > 0) { partStr = (digit > 1 ? String(Math.floor(part)).replace(/\B(?=(\d{4})+(?!\d))/g, ",") : '') + smallUnits[i] + partStr; }
                    }
                     // Use numbers instead of Korean characters for readability
                    result = String(part).replace(/\B(?=(\d{4})+(?!\d))/g, ",") + units[unitIndex] + ' ' + result;
                }
                number = Math.floor(number / 10000);
                unitIndex++;
            }
            return result.trim().replace(/,ë§Œ/g, "ë§Œ").replace(/,ì–µ/g, "ì–µ").replace(/,ì¡°/g, "ì¡°") + 'ì›';
        }

        function createAmountCard() {
            const amountValue = parseAmount(amountInput.value);
            if (amountValue <= 0) return;
            const koreanText = numberToKorean(amountValue);
            const card = document.createElement('div');
            card.className = 'amount-card';
            card.textContent = koreanText;
            card.dataset.amount = amountValue;
            
            const deleteBtn = document.createElement('span');
            deleteBtn.className = 'delete-card-btn';
            deleteBtn.innerHTML = '&times;';
            deleteBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                if (card === selectedCard) {
                    selectedCard = null;
                }
                card.remove();
            });
            card.appendChild(deleteBtn);

            card.addEventListener('click', handleCardClick);
            cardHolder.appendChild(card);
            amountInput.value = '';
        }

        function loadScenario() {
            if (usedIndices.size >= scenariosForDifficulty.length) {
                scenarioText.innerHTML = `<strong>${currentDifficulty.toUpperCase()} ë‚œì´ë„ì˜ ëª¨ë“  ë¬¸ì œë¥¼ í•´ê²°í–ˆìŠµë‹ˆë‹¤!</strong><br>ìµœì¢… ì ìˆ˜ë¥¼ í™•ì¸í•˜ì„¸ìš”. ë‹¤ë¥¸ ë‚œì´ë„ì— ë„ì „í•´ ë³´ì„¸ìš”.`;
                document.getElementById('interaction-area').style.display = 'none';
                submitBtn.style.display = 'none';
                nextBtn.style.display = 'none';
                return;
            }
            
            if (selectedCard) {
                selectedCard.classList.remove('selected');
                selectedCard = null;
            }
            isFirstAttempt = true;

            let randomIndex;
            do {
                randomIndex = Math.floor(Math.random() * scenariosForDifficulty.length);
            } while (usedIndices.has(randomIndex));
            
            usedIndices.add(randomIndex);
            currentScenario = scenariosForDifficulty[randomIndex];

            scenarioText.innerHTML = currentScenario.text;
            document.getElementById('interaction-area').style.display = 'block';
            heirDropZonesContainer.innerHTML = '';
            cardHolder.innerHTML = '';
            amountInput.value = '';
            
            currentScenario.characters.forEach(heir => {
                const dropZone = document.createElement('div');
                dropZone.className = 'drop-zone';
                dropZone.dataset.heir = heir;
                dropZone.innerHTML = `<span class="drop-zone-label">${heir}</span>`;
                dropZone.addEventListener('click', handleZoneClick);
                heirDropZonesContainer.appendChild(dropZone);
            });
            
            submitBtn.style.display = 'inline-block';
            nextBtn.style.display = 'none';
        }

        function checkAnswer() {
            const userAnswers = {};
            document.querySelectorAll('.drop-zone').forEach(zone => {
                const heir = zone.dataset.heir;
                const card = zone.querySelector('.amount-card');
                if (card) { userAnswers[heir] = parseInt(card.dataset.amount, 10); }
            });

            const correctSolution = currentScenario.solution.amounts;
            const correctHeirs = Object.keys(correctSolution);
            const userHeirs = Object.keys(userAnswers);

            let isCorrect = correctHeirs.length === userHeirs.length;
            if (isCorrect) {
                for (const heir of correctHeirs) {
                    if (userAnswers[heir] !== correctSolution[heir]) {
                        isCorrect = false;
                        break;
                    }
                }
            }
            
            answerModal.style.display = 'block';
            modalExplanation.innerHTML = `<strong>í•´ì„¤:</strong><br>${currentScenario.explanation.replace(/\n/g, '<br>')}`;

            nextBtn.classList.remove('correct', 'incorrect');
            if (isCorrect) {
                modalResult.textContent = "ì •ë‹µì…ë‹ˆë‹¤!";
                modalResult.style.color = "var(--success-color)";
                answerModal.querySelector('.modal-content').style.borderColor = "var(--success-color)";
                nextBtn.textContent = "ë‹¤ìŒ ë¬¸ì œ";
                nextBtn.classList.add('correct');
                
                if (isFirstAttempt) {
                    currentScore += 10;
                    scoreDisplay.textContent = `ì ìˆ˜: ${currentScore}`;
                    scoreDisplay.style.transform = 'scale(1.2)';
                    setTimeout(() => { scoreDisplay.style.transform = 'scale(1)'; }, 300);
                }
            } else {
                modalResult.textContent = "ì˜¤ë‹µì…ë‹ˆë‹¤.";
                modalResult.style.color = "var(--error-color)";
                answerModal.querySelector('.modal-content').style.borderColor = "var(--error-color)";
                nextBtn.textContent = "ë‹¤ì‹œ í’€ê¸°";
                nextBtn.classList.add('incorrect');
            }
            
            isFirstAttempt = false;
            submitBtn.style.display = 'none';
            nextBtn.style.display = 'inline-block';
        }

        // --- í´ë¦­ í•¸ë“¤ëŸ¬ ---
        function handleCardClick(e) {
            const clickedCard = e.currentTarget;
            if (e.target.classList.contains('delete-card-btn')) return;

            if (selectedCard === clickedCard) {
                selectedCard.classList.remove('selected');
                selectedCard = null;
            } else {
                if (selectedCard) {
                    selectedCard.classList.remove('selected');
                }
                selectedCard = clickedCard;
                selectedCard.classList.add('selected');
            }
        }

        function handleZoneClick(e) {
            if (!selectedCard) return;

            const targetZone = e.currentTarget;
            if (e.target.classList.contains('amount-card') || e.target.closest('.amount-card')) {
                return;
            }

            const isDropZone = targetZone.classList.contains('drop-zone');
            const isPool = targetZone.id === 'amount-card-pool';

            if (isDropZone) {
                if (!targetZone.querySelector('.amount-card')) {
                    targetZone.appendChild(selectedCard);
                } else {
                    return;
                }
            } else if (isPool) {
                cardHolder.appendChild(selectedCard);
            }

            selectedCard.classList.remove('selected');
            selectedCard = null;
        }

        // --- ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ---
        document.querySelectorAll('.difficulty-btn').forEach(btn => btn.addEventListener('click', e => showSimulatorScreen(e.target.dataset.difficulty)));
        backBtn.addEventListener('click', showDifficultyScreen);
        createCardBtn.addEventListener('click', createAmountCard);
        amountInput.addEventListener('keydown', e => { if (e.key === 'Enter') createAmountCard(); });
        submitBtn.addEventListener('click', checkAnswer);
        
        nextBtn.addEventListener('click', () => {
            answerModal.style.display = 'none';
            if (nextBtn.classList.contains('correct')) {
                loadScenario();
            } else { // 'ë‹¤ì‹œ í’€ê¸°' ë²„íŠ¼ í´ë¦­ ì‹œ
                submitBtn.style.display = 'inline-block';
                nextBtn.style.display = 'none';
            }
        });
        
        document.querySelectorAll('.modal .close-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                e.target.closest('.modal').style.display = 'none';
            });
        });

        answerModal.addEventListener('click', e => { if (e.target === answerModal) answerModal.style.display = 'none'; });
        howToUseModal.addEventListener('click', e => { if (e.target === howToUseModal) howToUseModal.style.display = 'none'; });
        
        amountCardPool.addEventListener('click', handleZoneClick);
        
        add10MBtn.addEventListener('click', () => {
            const currentValue = parseAmount(amountInput.value) || 0;
            amountInput.value = formatAmount(currentValue + 10000000);
        });
        add100MBtn.addEventListener('click', () => {
            const currentValue = parseAmount(amountInput.value) || 0;
            amountInput.value = formatAmount(currentValue + 100000000);
        });
        add1BBtn.addEventListener('click', () => {
            const currentValue = parseAmount(amountInput.value) || 0;
            amountInput.value = formatAmount(currentValue + 1000000000);
        });
        clearAmountBtn.addEventListener('click', () => {
            amountInput.value = '';
        });

        howToUseBtn.addEventListener('click', () => {
            howToUseModal.style.display = 'block';
        });

        // ì´ˆê¸° ë¡œë“œ
        showDifficultyScreen();
    </script>
</body>
</html>


